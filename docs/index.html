
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>FAAM Calibration netCDF documentation &#8212; Creation/updates of nc files for FAAM calibration data 0.3 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="cal-nc" href="_source/modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="_source/modules.html" title="cal-nc"
             accesskey="N">next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Creation/updates of nc files for FAAM calibration data 0.3 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">FAAM Calibration netCDF documentation</a><ul>
<li><a class="reference internal" href="#functions-and-modules">Functions and Modules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calibration-netcdf">Calibration netCDF</a><ul>
<li><a class="reference internal" href="#calibration-data-background">Calibration Data Background:</a></li>
<li><a class="reference internal" href="#introduction">Introduction:</a><ul>
<li><a class="reference internal" href="#calibration-files">Calibration files</a></li>
<li><a class="reference internal" href="#calibration-groups">Calibration groups</a></li>
<li><a class="reference internal" href="#time-series-data">Time series data</a></li>
<li><a class="reference internal" href="#data-and-calibration-referencing">Data and calibration referencing</a></li>
<li><a class="reference internal" href="#traceability">Traceability</a></li>
</ul>
</li>
<li><a class="reference internal" href="#file-structure">File Structure:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#netcdf-construction">netCDF Construction</a><ul>
<li><a class="reference internal" href="#cdl-templates">CDL templates:</a></li>
<li><a class="reference internal" href="#ancillary-files">Ancillary files:</a></li>
<li><a class="reference internal" href="#cal-ncgen-py-script-summary"><code class="docutils literal notranslate"><span class="pre">cal_ncgen.py</span></code> script summary:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#testing-calibration-netcdf">Testing Calibration netCDF</a></li>
<li><a class="reference internal" href="#example-creation-of-cal-nc-file">Example Creation of <cite>cal-nc</cite> File</a><ul>
<li><a class="reference internal" href="#initial-creation">Initial creation</a></li>
<li><a class="reference internal" href="#appending-to-existing-cal-nc-file">Appending to existing <cite>cal-nc</cite> file</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="_source/modules.html"
                        title="next chapter">cal-nc</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="faam-calibration-netcdf-documentation">
<h1>FAAM Calibration netCDF documentation<a class="headerlink" href="#faam-calibration-netcdf-documentation" title="Permalink to this headline">¶</a></h1>
<p>This document defines the netCDF file structure for storage of instrument calibration information as used by FAAM - the Facility for Airborne Atmospheric Measurements. These files provide traceability for all instrument calibrations, the linking of calibration information with applicable instrument data, and relevant calibration metadata all within a framework suitable for archiving.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-left">
<tbody>
<tr class="row-odd"><td><p>Project</p></td>
<td><p>FAAM Calibration netCDF</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Creation/updates of nc files for FAAM calibration data</p></td>
</tr>
<tr class="row-odd"><td><p>Project repository</p></td>
<td><p><a class="reference external" href="https://github.com/FAAM-146/cal-nc">https://github.com/FAAM-146/cal-nc</a></p></td>
</tr>
<tr class="row-even"><td><p>Project version</p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-odd"><td><p>Python version</p></td>
<td><p>3.7</p></td>
</tr>
<tr class="row-even"><td><p>Author</p></td>
<td><p>Graeme Nott &lt;<a class="reference external" href="mailto:graeme&#46;nott&#37;&#52;&#48;faam&#46;ac&#46;uk">graeme<span>&#46;</span>nott<span>&#64;</span>faam<span>&#46;</span>ac<span>&#46;</span>uk</a>&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>Created</p></td>
<td><p>Jan 2018</p></td>
</tr>
<tr class="row-even"><td><p>Modified</p></td>
<td><p>2020-04-24</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="functions-and-modules">
<h2>Functions and Modules<a class="headerlink" href="#functions-and-modules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="_source/modules.html">cal-nc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="_source/cal_cdl.html">cal_cdl package</a></li>
<li class="toctree-l2"><a class="reference internal" href="_source/cal_nc.html">cal_nc package</a></li>
<li class="toctree-l2"><a class="reference internal" href="_source/cal_ncgen.html">cal_ncgen module</a></li>
<li class="toctree-l2"><a class="reference internal" href="_source/cal_proc.html">cal_proc package</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="calibration-netcdf">
<h1>Calibration netCDF<a class="headerlink" href="#calibration-netcdf" title="Permalink to this headline">¶</a></h1>
<div class="section" id="calibration-data-background">
<h2>Calibration Data Background:<a class="headerlink" href="#calibration-data-background" title="Permalink to this headline">¶</a></h2>
<p>Instrument calibration is an integral part of scientific operations at FAAM as part of the mission to provide the highest level of quality assurance with measurements. The calibration procedures, traceability, and data itself must be provided to the end user in a manner that is clear, robust, and linked with the measurement data to which it applies.</p>
<p>Instrument calibration parameters to date have been dealt with in a somewhat piecemeal manner which has resulted in reduced transparency and clarity for the data user. Core primary instrument calibrations are generally held in a text file called the flight constants file. There is a unique file for each flight and the file contains all of the parameters that are applied to the raw data to convert them to physical units as contained within the FAAM core netCDF. Some instrument data, such as those contained within the core cloud physics netCDF, does not have calibrations applied. The relevant calibration data is supplied separately for the user to apply. These calibration text files are stored on the FAAM website and emailed out to users.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction:<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>To present calibration data in a consistent manner, facilitate archiving of the data, and improve traceability information and references, it is proposed to use a netCDF file of a specified structure. netCDF has been chosen as, although it is perhaps unnecessarily complicated for this application, it is commonly used for instrument data and is self-describing. The structure is flexible enough to hold many different types of instrument calibration information. The quantity of calibration information stored within the files will almost certainly be quite small so size and read/write speed are not a priority. Additionally, it is possible to insert these files into a netCDF4 data file as a sub-group and thus keep data and calibration together if that is beneficial.</p>
<p>The proposed structure has been set with several central tenets in mind;</p>
<ol class="arabic simple">
<li><p>The calibration information of an instrument is contained within a single calibration file instead of being spread across multiple files,</p></li>
<li><p>A single instrument may require several different calibrations in order to produce calibrated data. These different aspects of the calibration are contained in separate groups within the same netCDF file,</p></li>
<li><p>A single file holds a time series of comparable calibrations,</p></li>
<li><p>The calibration and measurement data files each contain references to the other. The data file should contain a boolean variable indicating whether the calibration has already been applied,</p></li>
<li><p>Calibrations are traceable by the inclusion of calibration metadata,</p></li>
<li><p>Future expansion with new instruments or more comprehensive calibrations of existing instrumentation can be accommodated.</p></li>
</ol>
<div class="section" id="calibration-files">
<h3>Calibration files<a class="headerlink" href="#calibration-files" title="Permalink to this headline">¶</a></h3>
<p>The idea is that each instrument has its own netCDF4 calibration file <a class="footnote-reference brackets" href="#fnote-multi-instr-nc" id="id1">1</a>, the filename shall follow current FAAM conventions with a structure such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">instr_faam_YYYYDDMM_v001_r000_cal</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">instr</span></code> is a unique string identifier for each instrument, <code class="docutils literal notranslate"><span class="pre">v001</span></code> refers to the version of the software that produced the netCDF, and <code class="docutils literal notranslate"><span class="pre">r000</span></code> gives the revision of the file.</p>
</div>
<div class="section" id="calibration-groups">
<h3>Calibration groups<a class="headerlink" href="#calibration-groups" title="Permalink to this headline">¶</a></h3>
<p>Some instruments may require different calibrations that are then both applied to the raw data within the processing software. An example of this is the PCASP; currently a calibration is applied to the flow meter readings plus a calibration is applied to the particle size bin boundaries. These two calibrations may be carried out at different times and they may be applied to the data at different times. Such instances  can be accommodated by using <code class="docutils literal notranslate"><span class="pre">groups</span></code> in a netCDF4 file. Calibrations are given in different groups within the same file with meaningful group names and metadata. The <code class="docutils literal notranslate"><span class="pre">time</span></code> coordinate may be in the root of the netCDF and apply to all groups or each group can have its own <code class="docutils literal notranslate"><span class="pre">time</span></code> coordinate if these differ between the different calibrations.</p>
</div>
<div class="section" id="time-series-data">
<h3>Time series data<a class="headerlink" href="#time-series-data" title="Permalink to this headline">¶</a></h3>
<p>Each file contains a time series of calibrations as long as these calibrations are comparable <a class="footnote-reference brackets" href="#fnote-noncomparable-cals" id="id2">2</a>.  Calibrations are held in an array with an unlimited dimension that is time/date of calibration. The standard name for this coordinate is <code class="docutils literal notranslate"><span class="pre">time</span></code> with the usual attributes of such a coordinate as detailed in the <a class="reference external" href="http://cfconventions.org/cf-conventions/cf-conventions.html#time-coordinate">CF conventions</a>.</p>
<p>This way it is straightforward to detect changes in comparable calibrations over time but also remove the possibility of comparing calibrations that are not comparable. For example, if the instrument undergoes a sensor upgrade, comparing calibrations from before and after this hardware change may not be meaningful.</p>
</div>
<div class="section" id="data-and-calibration-referencing">
<h3>Data and calibration referencing<a class="headerlink" href="#data-and-calibration-referencing" title="Permalink to this headline">¶</a></h3>
<p>It is important that calibration information is easily linked to those datasets to which it applies and that the end user of the dataset understands whether the calibrations have already been applied or not. These are possibly quite difficult to satisfy depending on the instrument.</p>
<p>In each calibration group there is a variable called <code class="docutils literal notranslate"><span class="pre">APPLIES_TO</span></code> which has an entry for each calibration time in the series that points to the applicable measurement data to which this calibration data has been or should be applied to. How this pointer is crafted at this stage is left to the individual as it may change instrument-to-instrument. It may be a data filename or it may be a string of applicable flight numbers for example. How a data file points to a particular calibration may also depend on the instrument and its particular calibration process.</p>
<p>In each calibration group there is also an attribute called <code class="docutils literal notranslate"><span class="pre">applied</span></code>. This is a boolean value that indicates if the calibration has already been applied to the data referred to in <code class="docutils literal notranslate"><span class="pre">APPLIED_TO</span></code>. If <code class="docutils literal notranslate"><span class="pre">applied</span> <span class="pre">==</span> <span class="pre">False</span></code> then the user should apply the calibration provided in the calibration netCDF to the data that they are using.</p>
</div>
<div class="section" id="traceability">
<h3>Traceability<a class="headerlink" href="#traceability" title="Permalink to this headline">¶</a></h3>
<p>Traceability of calibrations, calibration materials, and procedures is vital for user confidence in the data. The calibration netCDF has to hold this information within the file. This may include certificates provided by manufacturers or third party calibration facilities, descriptions of procedures or links to these that detail the methods used, and/or references to papers or textbooks that serve as the basis of the procedures <a class="footnote-reference brackets" href="#fnote-graphics-inclusion" id="id3">3</a>.</p>
<p>The structure provides several layers of references. In the root of the calibration netCDF file are global attributes <code class="docutils literal notranslate"><span class="pre">references</span></code> and <code class="docutils literal notranslate"><span class="pre">comment</span></code>, these apply to all calibration information within the entire file and so are necessarily general. Within each calibration group there may also be``references`` and <code class="docutils literal notranslate"><span class="pre">comment</span></code> attributes that provide direct textual information or a link to an external reference detailing the calibration procedure relevant to that calibration group.</p>
<p>Most specific is a <code class="docutils literal notranslate"><span class="pre">TRACEABILITY</span></code> variable within each calibration group that provides, for each calibration time, any information specific to that individual calibration. These may include calibration certificate information for materials and/or equipment used, links to external files containing this information, etc.</p>
</div>
</div>
<div class="section" id="file-structure">
<h2>File Structure:<a class="headerlink" href="#file-structure" title="Permalink to this headline">¶</a></h2>
<p>The file is divided into groups, as is possible with netCDF4, with the structure being as follows;</p>
<dl class="simple">
<dt>Global attributes of the root</dt><dd><p>Attributes that apply to the contents of the entire file. This metadata contains information about the netCDF conventions, institution where the data was produced, references, and any universally applicable instrument information such as name, serial number, etc. Additionally there is information about the history of the file. Many of these global attributes are defined in relevant conventions such as CF1.x.</p>
</dd>
<dt>Calibration groups</dt><dd><p>Separate calibration information is placed in different calibration groups. Each of these have group attributes with group-wide metadata.</p>
</dd>
</dl>
<p>Array dimensions for calibration data are organised so that with each new calibration that is added, the datetime dimension increases by one. Second and tertiary dimensions are set by the requirements of the instrument calibration.</p>
<dl class="simple">
<dt>First dimension - time</dt><dd><p>This is the unlimited dimension. This dimension is expanded each time a calibration is added to the file, which may be once a year or numerous times per flight.</p>
</dd>
<dt>Second dimension - cal</dt><dd><p>This is a fixed dimension for the calibration information. For example, this may be a list of three parameters for a cubic fit or a list of thirty bin threshold values.</p>
</dd>
<dt>Further dimensions - vector</dt><dd><p>These are fixed dimensions for any additional information. For example if the thirty bins have upper and lower threshold values.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="netcdf-construction">
<h1>netCDF Construction<a class="headerlink" href="#netcdf-construction" title="Permalink to this headline">¶</a></h1>
<p>Templates for calibration netCDF files are done by hand in <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/netcdf/CDL-Syntax.html">cdl</a>. This is a text equivalent of the binary netCDF. For some instruments, the amount of calibration data may be so small that it can all be included in the cdl template, if this is impractical extra data can be included in additional files. These other files may be cdl with the correct variables or they may have any other file format. These ancillary files are read in separately and the data written into variables of the calibration netCDF that is created with the cdl template.</p>
<div class="section" id="cdl-templates">
<h2>CDL templates:<a class="headerlink" href="#cdl-templates" title="Permalink to this headline">¶</a></h2>
<p>There is a <em>master</em> cdl file that is used to create the <em>master</em> netCDF. This may be an empty template for a particular instrument, these are stored in the <code class="docutils literal notranslate"><span class="pre">cal_cdl/</span></code> directory. Alternatively it may be based on such a template but have data values written in to the file. These would be stored wherever is most appropriate for that instrument calibration. Further information can be included in separate cdl files that are added/appended to the netCDF file produced by the <em>master</em> cdl file.</p>
<dl class="simple">
<dt>Instrument cdl 1</dt><dd><p>The top level instrument cdl has convention, institution, and instrument metadata that are written as netCDF global attributes. Convention and institution metadata are fixed. Instrument metadata applies to the entire file and includes instrument name/s, serial number, references, etc. Groups may be included in this file if there are multiple types of calibration for the same instrument. The primary coordinate is <cite>time</cite>, this may be a global attribute if it applies to all groups or may be a group coordinate if more appropriate. This cdl produces the <em>master</em> netCDF file (if no nc files are given).</p>
</dd>
<dt>Instrument cdl <em>n</em></dt><dd><p>Auxiliary instrument cdl file/s can be written. These may be used if the quantity of data becomes unwieldy for a single file. Any conflicts in terms of attributes and dimensions in the primary cdl file will be ignored but new variables shall be added and existing variables will be expanded in the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension.</p>
</dd>
</dl>
</div>
<div class="section" id="ancillary-files">
<h2>Ancillary files:<a class="headerlink" href="#ancillary-files" title="Permalink to this headline">¶</a></h2>
<p>It may be that the quantity or dimensionality of calibration data makes it unwieldy to write into the cdl file by hand. In these situations it is easier to write the calibration data into another type of file and use a customized parser to ingest this data, massage it into the appropriate form, and write it into the netCDF. If this is the case the parser and processor of the ancillary data are included in the instrument processing class.</p>
<p>These processors are stored in <code class="docutils literal notranslate"><span class="pre">cal_proc</span></code> in a file dedicated for each instrument. Universal methods are in <code class="docutils literal notranslate"><span class="pre">generic.py</span></code> and the instrument processors inherit from <code class="docutils literal notranslate"><span class="pre">Generic</span></code>.</p>
</div>
<div class="section" id="cal-ncgen-py-script-summary">
<h2><code class="docutils literal notranslate"><span class="pre">cal_ncgen.py</span></code> script summary:<a class="headerlink" href="#cal-ncgen-py-script-summary" title="Permalink to this headline">¶</a></h2>
<p>A helper script, <code class="docutils literal notranslate"><span class="pre">cal_ncgen.py</span></code> has been written to assist in creating and modifying the calibration netCDF files. The mandatory script argument is one or more cdl and/or nc files.</p>
<ul class="simple">
<li><p>If cdl, a new nc file will be created using the cdl as a template</p></li>
<li><p>If nc then new data is appended into this nc file</p></li>
</ul>
<p>If the input is cdl then ncgen is run to create an nc file <a class="footnote-reference brackets" href="#fnote-direct-ncgen-call" id="id4">4</a>. The first netCDF file argument is assumed to the <em>master</em> to which any additional information is added. If there is no netCDF files given then the first cdl file is used to create the <em>master</em> nc.</p>
<p>This nc file is then read in with the netCDF4 module. The instrument nickname is extracted from the resulting datasets global <code class="docutils literal notranslate"><span class="pre">instr</span></code> attribute and this is used to instantiate the appropriate class for that instrument. The simplest class is <code class="docutils literal notranslate"><span class="pre">Generic</span></code> which has some universal methods. All other classes inherit from Generic and may include other methods to parse from ancillary files and and write this data into the nc file. This parsing will be highly specific to an instrument, thus the individual classes.</p>
<p>It is possible to add/update individual attributes and variables as script arguments using the <code class="docutils literal notranslate"><span class="pre">--update</span></code> option.</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The testing for this option has been limited. Need to complete this.</p>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>These instructions assume that you are in a shell, either a terminal on a linux box or a <cite>git bash</cite> terminal on a Windows machine. You can also use various GUIs such as <a class="reference external" href="https://desktop.github.com">GitHub Desktop</a> but in this case you’re on your own.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This application uses <code class="docutils literal notranslate"><span class="pre">ncgen</span></code> which is part of the <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/docs/getting_and_building_netcdf.html">netCDF</a> package. It must be in the OS path so that it can be found by the script. It will usually be installed as part of the <code class="docutils literal notranslate"><span class="pre">netcdf4-python</span></code> package.</p>
</div>
</div></blockquote>
<ul class="simple">
<li><p>In a terminal clone the <code class="docutils literal notranslate"><span class="pre">cal-nc</span></code> repository (the instructions below assume you are installing into a user/git directory but it can be anywhere you like)</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">user@pc:~\git$</span> git clone git@github.com:FAAM-146/cal-nc.git
</pre></div>
</div>
<p>or if you prefer <cite>https</cite>,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">user@pc:~\git$</span> git clone https://github.com/FAAM-146/cal-nc.git
</pre></div>
</div>
<ul class="simple">
<li><p>Create a conda environment (after installing <a class="reference external" href="https://conda.io/en/latest/">conda</a> if necessary) using the environment file included in the repository;</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">user@pc:~\git$</span> <span class="nb">cd</span> cal-nc
<span class="gp">user@pc:~\git\cal-nc$</span> conda env create -f calnc-environment.yml
</pre></div>
</div>
<p>This shall create an environment called <code class="docutils literal notranslate"><span class="pre">cal-nc</span></code>.</p>
<ul class="simple">
<li><p>Activate the environment</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">user@pc:~\git\cal-nc$</span> conda activate cal-nc
</pre></div>
</div>
<ul class="simple">
<li><p>Classes, methods, and functions for the instrument processors are written in <code class="docutils literal notranslate"><span class="pre">cal_proc</span></code> while template instrument-specific cdl templates are in <code class="docutils literal notranslate"><span class="pre">cal_cdl</span></code>. The helper script <code class="docutils literal notranslate"><span class="pre">cal-ncgen.py</span></code> has been written to make the creation and maintenance of calibration netCDF files easier, full help exists so for examples of how to run it type</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(cal-nc) user@pc:~\git\cal-nc$ python cal_ncgen.py --help</span>
</pre></div>
</div>
<p>Files to test the code are in <code class="docutils literal notranslate"><span class="pre">testing</span></code>, see the readme in this directory for more information about running <code class="docutils literal notranslate"><span class="pre">cal_ncgen.py</span></code> with these files.</p>
<dl class="footnote brackets">
<dt class="label" id="fnote-multi-instr-nc"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Having only a single instrument in a file may mean a lot of almost empty files for many of the primary instruments. It may be possible to combine many such calibrations in a single calibration file through the use of links.</p>
</dd>
<dt class="label" id="fnote-noncomparable-cals"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>An exception to this may be when instrument calibrations are never comparable.</p>
</dd>
<dt class="label" id="fnote-graphics-inclusion"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>At this stage the feasibility of inclusion of graphics file/s of calibration certificates etc within the netCDF is unknown. Inclusion of raster data is done so should be possible to do. However no work on how practical in terms of writing, reading, and file sizes has been done so at this stage only links have been used. This means that a repository or database of these materials shall need to be kept separate to the calibration netCDF file.</p>
</dd>
<dt class="label" id="fnote-direct-ncgen-call"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>This means that a user can completely by-pass the use of this script and call <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/netcdf/ncgen.html">ncgen</a> directly on a user-generated cdl file. This is by design as it allows greater flexibility.</p>
</dd>
</dl>
</div>
<div class="section" id="testing-calibration-netcdf">
<h1>Testing Calibration netCDF<a class="headerlink" href="#testing-calibration-netcdf" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">/testing</span></code> directory includes some files to test the code and any scripts that you write.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(cal-nc) user@pc:~\git\cal-nc$ python cal_ncgen.py fred.nc bob.cdl testing/PCASP1_cal_test-1.cdl testing/PCASP1_cal_test-2.cdl --update parsefile testing/PCASP1_testcals.cfg -u comment &quot;testing stuff&quot; -o testing/PCASP1_test.nc</span>
</pre></div>
</div>
<p>This command does the following;</p>
<ul class="simple">
<li><p>Neither <code class="docutils literal notranslate"><span class="pre">fred.nc</span></code> nor <code class="docutils literal notranslate"><span class="pre">bob.cdl</span></code> exist so these files are ignored.</p></li>
<li><p>The <em>master</em> input cdl file is <code class="docutils literal notranslate"><span class="pre">PCASP1_cal_test-1.cdl</span></code>. A netCDF file shall be created from this and then subsequent calibration data shall be added/appended to it.</p></li>
<li><p>The second input file, <code class="docutils literal notranslate"><span class="pre">testing/PCASP1_cal_test-2.cdl</span></code> contains additional data in existing variables and groups and this shall be appended to the <em>master</em> nc file. Groups and variables that do not already exist within the <em>master</em> shall be added to it.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">--update</span></code> argument <code class="docutils literal notranslate"><span class="pre">parsefile</span></code> indicates that the configuration file <code class="docutils literal notranslate"><span class="pre">testing/PCASP1_testcals.cfg</span></code> should be parsed using a PCASP1-specific  parser and the data added/appended to the <em>master</em> nc.</p></li>
<li><p>An additional string in the root attribute <code class="docutils literal notranslate"><span class="pre">comment</span></code> shall be added to the <em>master</em> nc as long as it does not conflict with an existing attribute.</p></li>
<li><p>With the <code class="docutils literal notranslate"><span class="pre">-o</span></code> argument, the output is saved to the netCDF file <code class="docutils literal notranslate"><span class="pre">testing/PCASP1_test.nc</span></code>.</p></li>
</ul>
<p>Have a go…</p>
<blockquote>
<div><div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>This should be in a sphinx-readable file and README.rst pointed to the resultant file.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="example-creation-of-cal-nc-file">
<h1>Example Creation of <cite>cal-nc</cite> File<a class="headerlink" href="#example-creation-of-cal-nc-file" title="Permalink to this headline">¶</a></h1>
<div class="section" id="initial-creation">
<h2>Initial creation<a class="headerlink" href="#initial-creation" title="Permalink to this headline">¶</a></h2>
<p>The following command was used to create a <cite>cal-nc</cite> file for PCASP-2 using pre-ACRUISE and post-ARNA1 bin size calibrations and the sample flow calibrations from 8 May 2018.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(cal-nc) user@pc:~/git/cal-nc$ python cal_ncgen.py PCASP2_cal_template.cdl</span>
<span class="go">        -u parsefile &#39;/home/graeme/tmp/P2_cal/20191107_P2_cal.cfg&#39;</span>
<span class="go">        -u parsefile &#39;/home/graeme/tmp/P2_cal/20180508PCASP2_flowcal.cfg&#39;</span>
<span class="go">        --user=&quot;Graeme Nott &lt;graeme.nott@faam.ac.uk&gt;&quot;</span>
<span class="go">        --hist=&quot;&lt;now&gt; Initial creation&quot;</span>
<span class="go">        -o PCASP-2_faam_20191107_v001_r000_cal.nc</span>
</pre></div>
</div>
<p>This results in the cal-nc file;</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/FAAM-146/cal-nc/blob/master/testing/PCASP-2_faam_20191107_v001_r000_cal.nc">PCASP-2_faam_20191107_v001_r000_cal.nc</a></p>
</div></blockquote>
<p>Reading this netCDF file with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ncdump PCASP-2_faam_20191107_v001_r000_cal.nc &gt; PCASP-2_faam_20191107_v001_r000_cal.cdl</span>
</pre></div>
</div>
<p>results in the <cite>cdl</cite> file;</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/FAAM-146/cal-nc/blob/master/testing/PCASP_faam_20191107_v001_r000_cal.cdl">PCASP_faam_20191107_v001_r000_cal.cdl</a></p>
</div></blockquote>
<p>the contents of which are;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">PCASP_faam_20191107_v001_r000_cal</span> <span class="p">{</span>

<span class="o">//</span> <span class="k">global</span> <span class="n">attributes</span><span class="p">:</span>
    <span class="p">:</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s2">&quot;CF-1.6&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">institution</span> <span class="o">=</span> <span class="s2">&quot;FAAM. Facility for Airborne Atmospheric Measurements&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">address</span> <span class="o">=</span> <span class="s2">&quot;Building 146, Cranfield University, Cranfield MK43 0AL UK&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;FAAM calibration data for the PCASP-2&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;Laboratory-based calibration&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">instr</span> <span class="o">=</span> <span class="s2">&quot;PCASP-2&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">instr_long_name</span> <span class="o">=</span> <span class="s2">&quot;Passive Cavity Spectrometer Probe. SPP200 electronics package&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">instr_serialnumber</span> <span class="o">=</span> <span class="s2">&quot;PMI-1022-1202-31&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;http://www.faam.ac.uk/index.php/science-instruments/aerosol/304-pcasp&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;Graeme Nott &lt;graeme.nott@faam.ac.uk&gt;&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">history</span> <span class="o">=</span> <span class="s2">&quot;20191202T1747 Initial creation&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">software_version</span> <span class="o">=</span> <span class="s2">&quot;0.3&quot;</span> <span class="p">;</span>

<span class="n">group</span><span class="p">:</span> <span class="n">bin_cal</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">UNLIMITED</span> <span class="p">;</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span> <span class="n">currently</span><span class="p">)</span>
    <span class="nb">bin</span> <span class="o">=</span> <span class="mi">30</span> <span class="p">;</span>
    <span class="n">bin_bounds</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">;</span>
  <span class="n">variables</span><span class="p">:</span>
    <span class="nb">float</span> <span class="n">time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;time of calibration&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">timezone</span> <span class="o">=</span> <span class="s2">&quot;UTC&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;days since 1970-01-01 00:00:00&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">strftime_format</span> <span class="o">=</span> <span class="s2">&quot;days since %Y-%m-</span><span class="si">%d</span><span class="s2"> %Z&quot;</span> <span class="p">;</span>
    <span class="nb">int</span> <span class="nb">bin</span><span class="p">(</span><span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="nb">bin</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;bin number&quot;</span> <span class="p">;</span>
      <span class="nb">bin</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;The PCASP has 30 bins however the first has a somewhat undefined lower boundary and should therefore be discarded.&quot;</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">applies_to</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">applies_to</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Each calibration applies to these measurements&quot;</span> <span class="p">;</span>
      <span class="n">applies_to</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;String of applicable flight numbers for calibration&quot;</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">descr</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">descr</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Description of calibration&quot;</span> <span class="p">;</span>
      <span class="n">descr</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Campaign name/s for which these calibrations apply&quot;</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">traceability</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">traceability</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Traceability trail for each calibration&quot;</span> <span class="p">;</span>
      <span class="n">traceability</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Unique lot numbers for each calibration PSL. These can be traced to the original NIST-traceable certificates.&quot;</span> <span class="p">;</span>
    <span class="nb">int</span> <span class="n">cal_flag</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Flag denoting quality of calibration&quot;</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">valid_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">flag_values</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">flag_meanings</span> <span class="o">=</span> <span class="s2">&quot;good questionable poor missing_or_bad&quot;</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">;</span>
    <span class="nb">int</span> <span class="n">ADC_thres</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">bin_bounds</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">ADC_thres</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Lower and upper ADC thresholds for each bin&quot;</span> <span class="p">;</span>
      <span class="n">ADC_thres</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Coverage of each bin in terms of the digitized peak photovoltage. This variable has been included primarily for error checking as the same values should be in the standard data files.&quot;</span> <span class="p">;</span>
      <span class="n">ADC_thres</span><span class="p">:</span><span class="n">valid_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1288</span> <span class="p">;</span>
      <span class="n">ADC_thres</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2147483648</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">x</span><span class="o">-</span><span class="n">section</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">bin_bounds</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Scattering cross-section boundaries for each bin&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Lower boundary of first bin is undefined.&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;m**2&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section</span><span class="p">:</span><span class="n">ancillary_variables</span> <span class="o">=</span> <span class="s2">&quot;x-section_width_err&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">x</span><span class="o">-</span><span class="n">section_err</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">bin_bounds</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_err</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Uncertainty of scattering cross section boundaries for each bin&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_err</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Straight-line fits for scattering cross-section versus ADC voltage are calculated along with sensitivities to the uncertainty in these data. See section 2.2.3 of Rosenberg et al. (2012) for details.&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_err</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">x</span><span class="o">-</span><span class="n">section_width</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_width</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Width of each bin in terms of scattering cross section&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Uncertainty of scattering cross section boundaries for each bin&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span><span class="p">:</span><span class="n">flag_values</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span><span class="p">:</span><span class="n">flag_meanings</span> <span class="o">=</span> <span class="s2">&quot;Independent_uncertainties </span><span class="se">\n</span><span class="s2">                                             Dependent_uncertainties&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">dia_centre</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Centre diameter associated with each bin number for given particle material properties&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;This is the weighted average of each of the regions of the scattering curve which include the range of scattering cross-sections in each bin with the uncertainty of these boundaries included. This is discussed in sections 4.1 and 4.2 of Rosenberg et al. (2012).&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">refractive_index</span> <span class="o">=</span> <span class="s2">&quot;1.59+0i&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;spherical&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">ancillary_variables</span> <span class="o">=</span> <span class="s2">&quot;dia_centre_err dia_width&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">dia_centre_err</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">dia_centre_err</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Uncertainty of bin centre diameter&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre_err</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;See sections 4.1 and 4.2 of Rosenberg et al. (2012). for details.&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre_err</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span> <span class="p">;</span>
      <span class="n">dia_centre_err</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">dia_width</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Diameter width associated with each bin number for given particle material properties&quot;</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;This is the sum of all regions of the scattering curve which include the range of scattering cross-sections in each bin with the uncertainty of these boundaries included. This is discussed in sections 4.1 and 4.2 of Rosenberg et al. (2012).&quot;</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">refractive_index</span> <span class="o">=</span> <span class="s2">&quot;1.59+0i&quot;</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;spherical&quot;</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">ancillary_variables</span> <span class="o">=</span> <span class="s2">&quot;dia_width_err&quot;</span> <span class="p">;</span>
      <span class="n">dia_width</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">dia_width_err</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">bin</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">dia_width_err</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Uncertainty of bin width&quot;</span> <span class="p">;</span>
      <span class="n">dia_width_err</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;See sections 4.1 and 4.2 of Rosenberg et al. (2012). for details.&quot;</span> <span class="p">;</span>
      <span class="n">dia_width_err</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span> <span class="p">;</span>
      <span class="n">dia_width_err</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="n">f</span> <span class="p">;</span>

  <span class="o">//</span> <span class="n">group</span> <span class="n">attributes</span><span class="p">:</span>
      <span class="p">:</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Size bin calibration of PCASP&quot;</span> <span class="p">;</span>
      <span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Group containing calibration of size bins of the PCASP. Photodetector voltage pulse-heights are calibrated to the calculated scattering cross-section of known PSL and DEHS monodisperse distributions. Data contained in this group is copied straight from the existing csv calibration files.&quot;</span> <span class="p">;</span>
      <span class="p">:</span><span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;P.D. Rosenberg, A.R. Dean, P.I. Williams, J.R. Dorsey, A. Minikin, M.A. Pickering and A. Petzold, Particle sizing calibration with refractive index correction for light scattering optical particle counters and impacts upon PCASP and CDP data collected during the Fennec campaign, Atmos. Meas. Tech., 5, 1147-1163, doi:10.5194/amt-5-1147-2012, 2012.&quot;</span> <span class="p">;</span>
  <span class="n">data</span><span class="p">:</span>

   <span class="n">time</span> <span class="o">=</span> <span class="mi">18082</span><span class="p">,</span> <span class="mi">18208</span> <span class="p">;</span>

   <span class="nb">bin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> 
      <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span> <span class="p">;</span>

   <span class="n">applies_to</span> <span class="o">=</span> <span class="s2">&quot;C178-C212&quot;</span><span class="p">,</span> <span class="s2">&quot;C178-C212&quot;</span> <span class="p">;</span>

   <span class="n">descr</span> <span class="o">=</span> 
      <span class="s2">&quot;ACRUISE-1. MOYA Arctic wetlands. ACSIS-5. ARNA-1. DMA u/s. PSLs for mid-gain stage.&quot;</span><span class="p">,</span> 
      <span class="s2">&quot;ACRUISE-1. MOYA Arctic wetlands. ACSIS-5. ARNA-1. High-gain stage card u/s. Fine in flight-blew in lab?&quot;</span> <span class="p">;</span>

   <span class="n">traceability</span> <span class="o">=</span> 
      <span class="s2">&quot;125nm (#44245). 150nm (#202026). 203nm (#44793). 216nm (#16779). 240nm (#45059). 269nm (#166237). 303nm (#196947). 345nm (#199283). 400nm (#164245). 453nm (#166631). 508nm (#44115). 600nm (#166837). 707nm (#44582). 799nm (#164766). 903nm (#44869). 0.994um (#200992). 1.101um (#43973). 1.361um (#199629). 1.592um (#204268). 1.745um (#205235). 2.020um (#181058). 2.504um (#190272). 3.007um (#185943).&quot;</span><span class="p">,</span> 
      <span class="s2">&quot;269nm (#166237). 303nm (#196947). 345nm (#199283). 400nm (#164245). 453nm (#166631). 508nm (#44115). 600nm (#166837). 707nm (#44582). 799nm (#164766). 903nm (#44869). 0.994um (#200992). 1.101um (#43973). 1.361um (#199629). 1.592um (#204268). 1.745um (#205235). 2.020um (#181058). 2.504um (#190272). 3.007um (#185943).&quot;</span> <span class="p">;</span>

   <span class="n">cal_flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">;</span>

   <span class="n">ADC_thres</span> <span class="o">=</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="p">;</span>

   <span class="n">x</span><span class="o">-</span><span class="n">section</span> <span class="o">=</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="mf">0.00254097</span><span class="p">,</span>
  <span class="mf">0.00254097</span><span class="p">,</span> <span class="mf">0.00373883</span><span class="p">,</span>
  <span class="mf">0.00373883</span><span class="p">,</span> <span class="mf">0.00530527</span><span class="p">,</span>
  <span class="mf">0.00530527</span><span class="p">,</span> <span class="mf">0.00733242</span><span class="p">,</span>
  <span class="mf">0.00733242</span><span class="p">,</span> <span class="mf">0.0131375</span><span class="p">,</span>
  <span class="mf">0.0131375</span><span class="p">,</span> <span class="mf">0.0219832</span><span class="p">,</span>
  <span class="mf">0.0219832</span><span class="p">,</span> <span class="mf">0.0350676</span><span class="p">,</span>
  <span class="mf">0.0350676</span><span class="p">,</span> <span class="mf">0.053742</span><span class="p">,</span>
  <span class="mf">0.053742</span><span class="p">,</span> <span class="mf">0.079665</span><span class="p">,</span>
  <span class="mf">0.079665</span><span class="p">,</span> <span class="mf">0.125399</span><span class="p">,</span>
  <span class="mf">0.125399</span><span class="p">,</span> <span class="mf">0.485015</span><span class="p">,</span>
  <span class="mf">0.485015</span><span class="p">,</span> <span class="mf">0.741009</span><span class="p">,</span>
  <span class="mf">0.741009</span><span class="p">,</span> <span class="mf">0.958605</span><span class="p">,</span>
  <span class="mf">0.958605</span><span class="p">,</span> <span class="mf">1.59091</span><span class="p">,</span>
  <span class="mf">1.59091</span><span class="p">,</span> <span class="mf">2.13874</span><span class="p">,</span>
  <span class="mf">2.13874</span><span class="p">,</span> <span class="mf">2.68401</span><span class="p">,</span>
  <span class="mf">2.68401</span><span class="p">,</span> <span class="mf">3.24208</span><span class="p">,</span>
  <span class="mf">3.24208</span><span class="p">,</span> <span class="mf">3.65167</span><span class="p">,</span>
  <span class="mf">3.65167</span><span class="p">,</span> <span class="mf">4.29933</span><span class="p">,</span>
  <span class="mf">4.29933</span><span class="p">,</span> <span class="mf">4.95212</span><span class="p">,</span>
  <span class="mf">4.95212</span><span class="p">,</span> <span class="mf">5.9249</span><span class="p">,</span>
  <span class="mf">5.9249</span><span class="p">,</span> <span class="mf">6.9796</span><span class="p">,</span>
  <span class="mf">6.9796</span><span class="p">,</span> <span class="mf">8.13157</span><span class="p">,</span>
  <span class="mf">8.13157</span><span class="p">,</span> <span class="mf">9.25027</span><span class="p">,</span>
  <span class="mf">9.25027</span><span class="p">,</span> <span class="mf">10.6045</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="mf">0.0029679</span><span class="p">,</span>
  <span class="mf">0.0029679</span><span class="p">,</span> <span class="mf">0.00385074</span><span class="p">,</span>
  <span class="mf">0.00385074</span><span class="p">,</span> <span class="mf">0.00500521</span><span class="p">,</span>
  <span class="mf">0.00500521</span><span class="p">,</span> <span class="mf">0.00649923</span><span class="p">,</span>
  <span class="mf">0.00649923</span><span class="p">,</span> <span class="mf">0.0107776</span><span class="p">,</span>
  <span class="mf">0.0107776</span><span class="p">,</span> <span class="mf">0.017297</span><span class="p">,</span>
  <span class="mf">0.017297</span><span class="p">,</span> <span class="mf">0.0269402</span><span class="p">,</span>
  <span class="mf">0.0269402</span><span class="p">,</span> <span class="mf">0.0407034</span><span class="p">,</span>
  <span class="mf">0.0407034</span><span class="p">,</span> <span class="mf">0.0598088</span><span class="p">,</span>
  <span class="mf">0.0598088</span><span class="p">,</span> <span class="mf">0.0935149</span><span class="p">,</span>
  <span class="mf">0.0935149</span><span class="p">,</span> <span class="mf">0.360251</span><span class="p">,</span>
  <span class="mf">0.360251</span><span class="p">,</span> <span class="mf">0.545627</span><span class="p">,</span>
  <span class="mf">0.545627</span><span class="p">,</span> <span class="mf">0.703197</span><span class="p">,</span>
  <span class="mf">0.703197</span><span class="p">,</span> <span class="mf">1.16108</span><span class="p">,</span>
  <span class="mf">1.16108</span><span class="p">,</span> <span class="mf">1.55778</span><span class="p">,</span>
  <span class="mf">1.55778</span><span class="p">,</span> <span class="mf">1.95263</span><span class="p">,</span>
  <span class="mf">1.95263</span><span class="p">,</span> <span class="mf">2.35675</span><span class="p">,</span>
  <span class="mf">2.35675</span><span class="p">,</span> <span class="mf">2.65336</span><span class="p">,</span>
  <span class="mf">2.65336</span><span class="p">,</span> <span class="mf">3.12236</span><span class="p">,</span>
  <span class="mf">3.12236</span><span class="p">,</span> <span class="mf">3.59507</span><span class="p">,</span>
  <span class="mf">3.59507</span><span class="p">,</span> <span class="mf">4.2995</span><span class="p">,</span>
  <span class="mf">4.2995</span><span class="p">,</span> <span class="mf">5.06325</span><span class="p">,</span>
  <span class="mf">5.06325</span><span class="p">,</span> <span class="mf">5.89744</span><span class="p">,</span>
  <span class="mf">5.89744</span><span class="p">,</span> <span class="mf">6.70754</span><span class="p">,</span>
  <span class="mf">6.70754</span><span class="p">,</span> <span class="mf">7.68818</span> <span class="p">;</span>

   <span class="n">x</span><span class="o">-</span><span class="n">section_err</span> <span class="o">=</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="mf">0.000842166</span><span class="p">,</span>
  <span class="mf">0.000842166</span><span class="p">,</span> <span class="mf">0.000787564</span><span class="p">,</span>
  <span class="mf">0.000787564</span><span class="p">,</span> <span class="mf">0.000722996</span><span class="p">,</span>
  <span class="mf">0.000722996</span><span class="p">,</span> <span class="mf">0.00065436</span><span class="p">,</span>
  <span class="mf">0.00065436</span><span class="p">,</span> <span class="mf">0.000595998</span><span class="p">,</span>
  <span class="mf">0.000595998</span><span class="p">,</span> <span class="mf">0.000898705</span><span class="p">,</span>
  <span class="mf">0.000898705</span><span class="p">,</span> <span class="mf">0.00165073</span><span class="p">,</span>
  <span class="mf">0.00165073</span><span class="p">,</span> <span class="mf">0.00283561</span><span class="p">,</span>
  <span class="mf">0.00283561</span><span class="p">,</span> <span class="mf">0.00452195</span><span class="p">,</span>
  <span class="mf">0.00452195</span><span class="p">,</span> <span class="mf">0.00752266</span><span class="p">,</span>
  <span class="mf">0.00752266</span><span class="p">,</span> <span class="mf">0.012612</span><span class="p">,</span>
  <span class="mf">0.012612</span><span class="p">,</span> <span class="mf">0.0136605</span><span class="p">,</span>
  <span class="mf">0.0136605</span><span class="p">,</span> <span class="mf">0.0189594</span><span class="p">,</span>
  <span class="mf">0.0189594</span><span class="p">,</span> <span class="mf">0.0405093</span><span class="p">,</span>
  <span class="mf">0.0405093</span><span class="p">,</span> <span class="mf">0.0607357</span><span class="p">,</span>
  <span class="mf">0.0607357</span><span class="p">,</span> <span class="mf">0.0811873</span><span class="p">,</span>
  <span class="mf">0.0811873</span><span class="p">,</span> <span class="mf">0.102249</span><span class="p">,</span>
  <span class="mf">0.102249</span><span class="p">,</span> <span class="mf">0.117751</span><span class="p">,</span>
  <span class="mf">0.117751</span><span class="p">,</span> <span class="mf">0.142306</span><span class="p">,</span>
  <span class="mf">0.142306</span><span class="p">,</span> <span class="mf">0.167087</span><span class="p">,</span>
  <span class="mf">0.167087</span><span class="p">,</span> <span class="mf">0.20405</span><span class="p">,</span>
  <span class="mf">0.20405</span><span class="p">,</span> <span class="mf">0.244153</span><span class="p">,</span>
  <span class="mf">0.244153</span><span class="p">,</span> <span class="mf">0.287975</span><span class="p">,</span>
  <span class="mf">0.287975</span><span class="p">,</span> <span class="mf">0.330541</span><span class="p">,</span>
  <span class="mf">0.330541</span><span class="p">,</span> <span class="mf">0.38208</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="mf">0.000137067</span><span class="p">,</span>
  <span class="mf">0.000137067</span><span class="p">,</span> <span class="mf">0.000133914</span><span class="p">,</span>
  <span class="mf">0.000133914</span><span class="p">,</span> <span class="mf">0.000130805</span><span class="p">,</span>
  <span class="mf">0.000130805</span><span class="p">,</span> <span class="mf">0.000128608</span><span class="p">,</span>
  <span class="mf">0.000128608</span><span class="p">,</span> <span class="mf">0.000134149</span><span class="p">,</span>
  <span class="mf">0.000134149</span><span class="p">,</span> <span class="mf">0.000170348</span><span class="p">,</span>
  <span class="mf">0.000170348</span><span class="p">,</span> <span class="mf">0.000254588</span><span class="p">,</span>
  <span class="mf">0.000254588</span><span class="p">,</span> <span class="mf">0.000395214</span><span class="p">,</span>
  <span class="mf">0.000395214</span><span class="p">,</span> <span class="mf">0.000601313</span><span class="p">,</span>
  <span class="mf">0.000601313</span><span class="p">,</span> <span class="mf">0.000972904</span><span class="p">,</span>
  <span class="mf">0.000972904</span><span class="p">,</span> <span class="mf">0.0209624</span><span class="p">,</span>
  <span class="mf">0.0209624</span><span class="p">,</span> <span class="mf">0.0196167</span><span class="p">,</span>
  <span class="mf">0.0196167</span><span class="p">,</span> <span class="mf">0.0194257</span><span class="p">,</span>
  <span class="mf">0.0194257</span><span class="p">,</span> <span class="mf">0.0236399</span><span class="p">,</span>
  <span class="mf">0.0236399</span><span class="p">,</span> <span class="mf">0.0309919</span><span class="p">,</span>
  <span class="mf">0.0309919</span><span class="p">,</span> <span class="mf">0.0398196</span><span class="p">,</span>
  <span class="mf">0.0398196</span><span class="p">,</span> <span class="mf">0.0495798</span><span class="p">,</span>
  <span class="mf">0.0495798</span><span class="p">,</span> <span class="mf">0.0569947</span><span class="p">,</span>
  <span class="mf">0.0569947</span><span class="p">,</span> <span class="mf">0.0689699</span><span class="p">,</span>
  <span class="mf">0.0689699</span><span class="p">,</span> <span class="mf">0.0812289</span><span class="p">,</span>
  <span class="mf">0.0812289</span><span class="p">,</span> <span class="mf">0.0996988</span><span class="p">,</span>
  <span class="mf">0.0996988</span><span class="p">,</span> <span class="mf">0.119881</span><span class="p">,</span>
  <span class="mf">0.119881</span><span class="p">,</span> <span class="mf">0.14203</span><span class="p">,</span>
  <span class="mf">0.14203</span><span class="p">,</span> <span class="mf">0.163605</span><span class="p">,</span>
  <span class="mf">0.163605</span><span class="p">,</span> <span class="mf">0.189776</span> <span class="p">;</span>

   <span class="n">x</span><span class="o">-</span><span class="n">section_width</span> <span class="o">=</span>
  <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="mf">0.00119786</span><span class="p">,</span> <span class="mf">0.00156644</span><span class="p">,</span> 
      <span class="mf">0.00202715</span><span class="p">,</span> <span class="mf">0.00580503</span><span class="p">,</span> <span class="mf">0.00884576</span><span class="p">,</span> <span class="mf">0.0130844</span><span class="p">,</span> <span class="mf">0.0186744</span><span class="p">,</span> <span class="mf">0.025923</span><span class="p">,</span> 
      <span class="mf">0.0457338</span><span class="p">,</span> <span class="mf">0.359616</span><span class="p">,</span> <span class="mf">0.255995</span><span class="p">,</span> <span class="mf">0.217595</span><span class="p">,</span> <span class="mf">0.632307</span><span class="p">,</span> <span class="mf">0.547828</span><span class="p">,</span> <span class="mf">0.545268</span><span class="p">,</span> 
      <span class="mf">0.558068</span><span class="p">,</span> <span class="mf">0.409591</span><span class="p">,</span> <span class="mf">0.647666</span><span class="p">,</span> <span class="mf">0.652786</span><span class="p">,</span> <span class="mf">0.972779</span><span class="p">,</span> <span class="mf">1.0547</span><span class="p">,</span> <span class="mf">1.15198</span><span class="p">,</span> 
      <span class="mf">1.1187</span><span class="p">,</span> <span class="mf">1.35421</span><span class="p">,</span>
  <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="mf">0.000882833</span><span class="p">,</span> <span class="mf">0.00115447</span><span class="p">,</span> 
      <span class="mf">0.00149403</span><span class="p">,</span> <span class="mf">0.00427835</span><span class="p">,</span> <span class="mf">0.00651938</span><span class="p">,</span> <span class="mf">0.00964326</span><span class="p">,</span> <span class="mf">0.0137631</span><span class="p">,</span> <span class="mf">0.0191054</span><span class="p">,</span> 
      <span class="mf">0.0337061</span><span class="p">,</span> <span class="mf">0.266736</span><span class="p">,</span> <span class="mf">0.185376</span><span class="p">,</span> <span class="mf">0.15757</span><span class="p">,</span> <span class="mf">0.457879</span><span class="p">,</span> <span class="mf">0.396705</span><span class="p">,</span> <span class="mf">0.394852</span><span class="p">,</span> 
      <span class="mf">0.40412</span><span class="p">,</span> <span class="mf">0.296602</span><span class="p">,</span> <span class="mf">0.469002</span><span class="p">,</span> <span class="mf">0.47271</span><span class="p">,</span> <span class="mf">0.70443</span><span class="p">,</span> <span class="mf">0.76375</span><span class="p">,</span> <span class="mf">0.834193</span><span class="p">,</span> 
      <span class="mf">0.810094</span><span class="p">,</span> <span class="mf">0.980641</span> <span class="p">;</span>

   <span class="n">x</span><span class="o">-</span><span class="n">section_width_err</span> <span class="o">=</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="mf">7.89979e-05</span><span class="p">,</span> <span class="mf">0.000103305</span><span class="p">,</span> <span class="mf">0.000133689</span><span class="p">,</span> <span class="mf">0.000382836</span><span class="p">,</span> 
      <span class="mf">0.000583369</span><span class="p">,</span> <span class="mf">0.0008629</span><span class="p">,</span> <span class="mf">0.00123156</span><span class="p">,</span> <span class="mf">0.0017096</span><span class="p">,</span> <span class="mf">0.0030161</span><span class="p">,</span> <span class="mf">0.01394</span><span class="p">,</span> 
      <span class="mf">0.00974825</span><span class="p">,</span> <span class="mf">0.00828601</span><span class="p">,</span> <span class="mf">0.0240782</span><span class="p">,</span> <span class="mf">0.0208613</span><span class="p">,</span> <span class="mf">0.0207638</span><span class="p">,</span> <span class="mf">0.0212512</span><span class="p">,</span> 
      <span class="mf">0.0155972</span><span class="p">,</span> <span class="mf">0.0246631</span><span class="p">,</span> <span class="mf">0.024858</span><span class="p">,</span> <span class="mf">0.0370434</span><span class="p">,</span> <span class="mf">0.0401628</span><span class="p">,</span> <span class="mf">0.0438671</span><span class="p">,</span> 
      <span class="mf">0.0425999</span><span class="p">,</span> <span class="mf">0.0515682</span><span class="p">,</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="mf">9.87289e-06</span><span class="p">,</span> <span class="mf">1.29107e-05</span><span class="p">,</span> <span class="mf">1.6708e-05</span><span class="p">,</span> <span class="mf">4.78456e-05</span><span class="p">,</span> 
      <span class="mf">7.29075e-05</span><span class="p">,</span> <span class="mf">0.000107842</span><span class="p">,</span> <span class="mf">0.000153916</span><span class="p">,</span> <span class="mf">0.00021366</span><span class="p">,</span> <span class="mf">0.000376942</span><span class="p">,</span> 
      <span class="mf">0.0071177</span><span class="p">,</span> <span class="mf">0.00497741</span><span class="p">,</span> <span class="mf">0.0042308</span><span class="p">,</span> <span class="mf">0.0122942</span><span class="p">,</span> <span class="mf">0.0106517</span><span class="p">,</span> <span class="mf">0.0106019</span><span class="p">,</span> 
      <span class="mf">0.0108508</span><span class="p">,</span> <span class="mf">0.00796386</span><span class="p">,</span> <span class="mf">0.0125929</span><span class="p">,</span> <span class="mf">0.0126924</span><span class="p">,</span> <span class="mf">0.0189142</span><span class="p">,</span> <span class="mf">0.0205069</span><span class="p">,</span> 
      <span class="mf">0.0223984</span><span class="p">,</span> <span class="mf">0.0217513</span><span class="p">,</span> <span class="mf">0.0263305</span> <span class="p">;</span>

   <span class="n">dia_centre</span> <span class="o">=</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.161532</span><span class="p">,</span> <span class="mf">0.172353</span><span class="p">,</span> <span class="mf">0.182843</span><span class="p">,</span> <span class="mf">0.198507</span><span class="p">,</span> <span class="mf">0.219736</span><span class="p">,</span> 
      <span class="mf">0.242032</span><span class="p">,</span> <span class="mf">0.265824</span><span class="p">,</span> <span class="mf">0.290497</span><span class="p">,</span> <span class="mf">0.3175</span><span class="p">,</span> <span class="mf">0.430883</span><span class="p">,</span> <span class="mf">0.601522</span><span class="p">,</span> <span class="mf">0.732623</span><span class="p">,</span> 
      <span class="mf">0.935458</span><span class="p">,</span> <span class="mf">1.31996</span><span class="p">,</span> <span class="mf">1.68059</span><span class="p">,</span> <span class="mf">1.89863</span><span class="p">,</span> <span class="mf">2.0102</span><span class="p">,</span> <span class="mf">2.17978</span><span class="p">,</span> <span class="mf">2.34456</span><span class="p">,</span> <span class="mf">2.56224</span><span class="p">,</span> 
      <span class="mf">2.80224</span><span class="p">,</span> <span class="mf">3.14323</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.164496</span><span class="p">,</span> <span class="mf">0.17204</span><span class="p">,</span> <span class="mf">0.180024</span><span class="p">,</span> <span class="mf">0.192814</span><span class="p">,</span> <span class="mf">0.210777</span><span class="p">,</span> 
      <span class="mf">0.230073</span><span class="p">,</span> <span class="mf">0.25094</span><span class="p">,</span> <span class="mf">0.273276</span><span class="p">,</span> <span class="mf">0.299024</span><span class="p">,</span> <span class="mf">0.394132</span><span class="p">,</span> <span class="mf">0.520465</span><span class="p">,</span> <span class="mf">0.611762</span><span class="p">,</span> 
      <span class="mf">0.783025</span><span class="p">,</span> <span class="mf">0.990889</span><span class="p">,</span> <span class="mf">1.25383</span><span class="p">,</span> <span class="mf">1.49448</span><span class="p">,</span> <span class="mf">1.75573</span><span class="p">,</span> <span class="mf">1.85423</span><span class="p">,</span> <span class="mf">2.0145</span><span class="p">,</span> 
      <span class="mf">2.17242</span><span class="p">,</span> <span class="mf">2.36007</span><span class="p">,</span> <span class="mf">2.57308</span><span class="p">,</span> <span class="mf">2.76148</span><span class="p">,</span> <span class="mf">3.05446</span> <span class="p">;</span>

   <span class="n">dia_centre_err</span> <span class="o">=</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.00545099</span><span class="p">,</span> <span class="mf">0.00334094</span><span class="p">,</span> <span class="mf">0.0019438</span><span class="p">,</span> <span class="mf">0.00057022</span><span class="p">,</span> 
      <span class="mf">0.000782926</span><span class="p">,</span> <span class="mf">0.00181591</span><span class="p">,</span> <span class="mf">0.00268728</span><span class="p">,</span> <span class="mf">0.0033132</span><span class="p">,</span> <span class="mf">0.00264808</span><span class="p">,</span> <span class="mf">0.00329778</span><span class="p">,</span> 
      <span class="mf">0.00056109</span><span class="p">,</span> <span class="mf">0.00306263</span><span class="p">,</span> <span class="mf">0.00460748</span><span class="p">,</span> <span class="mf">0.0181687</span><span class="p">,</span> <span class="mf">0.0453911</span><span class="p">,</span> <span class="mf">0.0394052</span><span class="p">,</span> 
      <span class="mf">0.00746736</span><span class="p">,</span> <span class="mf">0.0348722</span><span class="p">,</span> <span class="mf">0.0412279</span><span class="p">,</span> <span class="mf">0.0449035</span><span class="p">,</span> <span class="mf">0.0693954</span><span class="p">,</span> <span class="mf">0.0622692</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.000669252</span><span class="p">,</span> <span class="mf">0.000501786</span><span class="p">,</span> <span class="mf">0.000374634</span><span class="p">,</span> <span class="mf">0.000267259</span><span class="p">,</span> 
      <span class="mf">0.000260592</span><span class="p">,</span> <span class="mf">0.000345078</span><span class="p">,</span> <span class="mf">0.000452744</span><span class="p">,</span> <span class="mf">0.000554664</span><span class="p">,</span> <span class="mf">0.000452017</span><span class="p">,</span> 
      <span class="mf">0.00667331</span><span class="p">,</span> <span class="mf">0.0039655</span><span class="p">,</span> <span class="mf">0.00127977</span><span class="p">,</span> <span class="mf">0.00251333</span><span class="p">,</span> <span class="mf">0.00446769</span><span class="p">,</span> <span class="mf">0.0265541</span><span class="p">,</span> 
      <span class="mf">0.0277948</span><span class="p">,</span> <span class="mf">0.0296127</span><span class="p">,</span> <span class="mf">0.033018</span><span class="p">,</span> <span class="mf">0.00832448</span><span class="p">,</span> <span class="mf">0.0177613</span><span class="p">,</span> <span class="mf">0.032053</span><span class="p">,</span> 
      <span class="mf">0.027667</span><span class="p">,</span> <span class="mf">0.0255453</span><span class="p">,</span> <span class="mf">0.0454228</span> <span class="p">;</span>

   <span class="n">dia_width</span> <span class="o">=</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0110807</span><span class="p">,</span> <span class="mf">0.0105606</span><span class="p">,</span> <span class="mf">0.0104203</span><span class="p">,</span> <span class="mf">0.0209073</span><span class="p">,</span> <span class="mf">0.021551</span><span class="p">,</span> 
      <span class="mf">0.0230407</span><span class="p">,</span> <span class="mf">0.024543</span><span class="p">,</span> <span class="mf">0.0248039</span><span class="p">,</span> <span class="mf">0.0292088</span><span class="p">,</span> <span class="mf">0.197556</span><span class="p">,</span> <span class="mf">0.144091</span><span class="p">,</span> 
      <span class="mf">0.118111</span><span class="p">,</span> <span class="mf">0.287558</span><span class="p">,</span> <span class="mf">0.432708</span><span class="p">,</span> <span class="mf">0.288753</span><span class="p">,</span> <span class="mf">0.228328</span><span class="p">,</span> <span class="mf">0.09849</span><span class="p">,</span> <span class="mf">0.147777</span><span class="p">,</span> 
      <span class="mf">0.139107</span><span class="p">,</span> <span class="mf">0.274045</span><span class="p">,</span> <span class="mf">0.238714</span><span class="p">,</span> <span class="mf">0.393081</span><span class="p">,</span> <span class="mf">0.266215</span><span class="p">,</span> <span class="mf">0.282616</span><span class="p">,</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.00731525</span><span class="p">,</span> <span class="mf">0.00777243</span><span class="p">,</span> <span class="mf">0.0081962</span><span class="p">,</span> <span class="mf">0.017384</span><span class="p">,</span> <span class="mf">0.0185429</span><span class="p">,</span> 
      <span class="mf">0.0200482</span><span class="p">,</span> <span class="mf">0.0216851</span><span class="p">,</span> <span class="mf">0.0229881</span><span class="p">,</span> <span class="mf">0.0285085</span><span class="p">,</span> <span class="mf">0.161707</span><span class="p">,</span> <span class="mf">0.0882481</span><span class="p">,</span> 
      <span class="mf">0.0943458</span><span class="p">,</span> <span class="mf">0.248179</span><span class="p">,</span> <span class="mf">0.16755</span><span class="p">,</span> <span class="mf">0.26987</span><span class="p">,</span> <span class="mf">0.302136</span><span class="p">,</span> <span class="mf">0.136449</span><span class="p">,</span> <span class="mf">0.188126</span><span class="p">,</span> 
      <span class="mf">0.147882</span><span class="p">,</span> <span class="mf">0.158893</span><span class="p">,</span> <span class="mf">0.16331</span><span class="p">,</span> <span class="mf">0.240932</span><span class="p">,</span> <span class="mf">0.18003</span><span class="p">,</span> <span class="mf">0.320907</span> <span class="p">;</span>

   <span class="n">dia_width_err</span> <span class="o">=</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.00261851</span><span class="p">,</span> <span class="mf">0.00163823</span><span class="p">,</span> <span class="mf">0.00116194</span><span class="p">,</span> <span class="mf">0.00158655</span><span class="p">,</span> 
      <span class="mf">0.00111861</span><span class="p">,</span> <span class="mf">0.000947636</span><span class="p">,</span> <span class="mf">0.00079547</span><span class="p">,</span> <span class="mf">0.00045792</span><span class="p">,</span> <span class="mf">0.00529615</span><span class="p">,</span> 
      <span class="mf">0.00659557</span><span class="p">,</span> <span class="mf">0.00406565</span><span class="p">,</span> <span class="mf">0.000949336</span><span class="p">,</span> <span class="mf">0.00267623</span><span class="p">,</span> <span class="mf">0.0324692</span><span class="p">,</span> <span class="mf">0.0111308</span><span class="p">,</span> 
      <span class="mf">0.00933062</span><span class="p">,</span> <span class="mf">0.0273542</span><span class="p">,</span> <span class="mf">0.0117725</span><span class="p">,</span> <span class="mf">0.019486</span><span class="p">,</span> <span class="mf">0.0114616</span><span class="p">,</span> <span class="mf">0.031484</span><span class="p">,</span> 
      <span class="mf">0.0313069</span><span class="p">,</span> <span class="mf">0.0150962</span><span class="p">,</span> <span class="mf">0.0280426</span><span class="p">,</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.000198556</span><span class="p">,</span> <span class="mf">0.000163383</span><span class="p">,</span> <span class="mf">0.000136567</span><span class="p">,</span> <span class="mf">0.000207127</span><span class="p">,</span> 
      <span class="mf">0.000155022</span><span class="p">,</span> <span class="mf">0.000132795</span><span class="p">,</span> <span class="mf">0.000123279</span><span class="p">,</span> <span class="mf">9.82858e-05</span><span class="p">,</span> <span class="mf">0.000904034</span><span class="p">,</span> 
      <span class="mf">0.0133466</span><span class="p">,</span> <span class="mf">0.00228647</span><span class="p">,</span> <span class="mf">0.00312676</span><span class="p">,</span> <span class="mf">0.00446463</span><span class="p">,</span> <span class="mf">0.000615445</span><span class="p">,</span> <span class="mf">0.0364292</span><span class="p">,</span> 
      <span class="mf">0.0143763</span><span class="p">,</span> <span class="mf">0.00698934</span><span class="p">,</span> <span class="mf">0.00989404</span><span class="p">,</span> <span class="mf">0.0215446</span><span class="p">,</span> <span class="mf">0.00544942</span><span class="p">,</span> <span class="mf">0.0209264</span><span class="p">,</span> 
      <span class="mf">0.0138259</span><span class="p">,</span> <span class="mf">0.0134272</span><span class="p">,</span> <span class="mf">0.0478624</span> <span class="p">;</span>
  <span class="p">}</span> <span class="o">//</span> <span class="n">group</span> <span class="n">bin_cal</span>

<span class="n">group</span><span class="p">:</span> <span class="n">flow_cal</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">UNLIMITED</span> <span class="p">;</span> <span class="o">//</span> <span class="p">(</span><span class="mi">1</span> <span class="n">currently</span><span class="p">)</span>
    <span class="n">max_flows</span> <span class="o">=</span> <span class="mi">64</span> <span class="p">;</span>
  <span class="n">variables</span><span class="p">:</span>
    <span class="nb">float</span> <span class="n">time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;time of calibration&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">timezone</span> <span class="o">=</span> <span class="s2">&quot;UTC&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;days since 1970-01-01 00:00:00&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">strftime_format</span> <span class="o">=</span> <span class="s2">&quot;days since %Y-%m-</span><span class="si">%d</span><span class="s2"> %Z&quot;</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">applies_to</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">applies_to</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Each calibration applies to these measurements&quot;</span> <span class="p">;</span>
      <span class="n">applies_to</span><span class="p">:</span><span class="n">comments</span> <span class="o">=</span> <span class="s2">&quot;String of applicable flight numbers for calibration&quot;</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">descr</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">descr</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Description of calibration&quot;</span> <span class="p">;</span>
      <span class="n">descr</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Campaign name/s for which these calibrations apply&quot;</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">traceability</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">traceability</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Traceability trail for each calibration&quot;</span> <span class="p">;</span>
      <span class="n">traceability</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Calibration of low flow cell s/n 1702010-L&quot;</span> <span class="p">;</span>
    <span class="nb">int</span> <span class="n">cal_flag</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Flag denoting quality of calibration&quot;</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">valid_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">flag_values</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">flag_meanings</span> <span class="o">=</span> <span class="s2">&quot;good questionable poor missing_or_bad&quot;</span> <span class="p">;</span>
      <span class="n">cal_flag</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">flows_reported</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">max_flows</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">flows_reported</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Array of flow rates reported by PCASP for each value in flows_actual&quot;</span> <span class="p">;</span>
      <span class="n">flows_reported</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;The number of different flows included in each calibration will differ depending on operator and circumstance. The maximum possible flows is given by the dimension max_flows. The variable is padded by the _FillValue. It is the users obligation to check that the number of flows_reported for each time is the same as flows_actual for that time.&quot;</span> <span class="p">;</span>
      <span class="n">flows_reported</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;cc/s&quot;</span> <span class="p">;</span>
      <span class="n">flows_reported</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="n">NaNf</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">flows_actual</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">max_flows</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">flows_actual</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Array of actual flow rates for each value in flows_reported&quot;</span> <span class="p">;</span>
      <span class="n">flows_actual</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;The number of different flows included in each calibration will differ depending on operator and circumstance. The maximum possible flows is given by the dimension max_flows. The variable is padded by the _FillValue. It is the users obligation to check that the number of flows_actual for each time is the same as flows_reported for that time.&quot;</span> <span class="p">;</span>
      <span class="n">flows_actual</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;cc/s&quot;</span> <span class="p">;</span>
      <span class="n">flows_actual</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="n">NaNf</span> <span class="p">;</span>
    <span class="n">string</span> <span class="n">flow_fit</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">flow_fit</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Calibration equation of sample flow.&quot;</span> <span class="p">;</span>
      <span class="n">flow_fit</span><span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;String of equation used to convert reported flow to calibrated flow rate. This will involve a fit to the data given for the same time stamp in the flows variable. A string is used for flexibility but may be changed to polynomial values in the future if appropriate.&quot;</span> <span class="p">;</span>
      <span class="n">string</span> <span class="n">flow_fit</span><span class="p">:</span><span class="n">_FillValue</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>

  <span class="o">//</span> <span class="n">group</span> <span class="n">attributes</span><span class="p">:</span>
      <span class="p">:</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Flow calibration of PCASP&quot;</span> <span class="p">;</span>
      <span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Gilibrator 2 small cell (to 250cc/m) connected to outlet of PCASP1. Small CV needle valve used to throttle inlet flow with inline Alicat flowmeter used to measure T &amp; P of inlet air&quot;</span> <span class="p">;</span>
      <span class="p">:</span><span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;http://www.faam.ac.uk/index.php/science-instruments/aerosol/304-pcasp&quot;</span> <span class="p">;</span>
  <span class="n">data</span><span class="p">:</span>

   <span class="n">time</span> <span class="o">=</span> <span class="mi">17660</span> <span class="p">;</span>

   <span class="n">applies_to</span> <span class="o">=</span> <span class="s2">&quot;C173-&quot;</span> <span class="p">;</span>

   <span class="n">descr</span> <span class="o">=</span> <span class="n">_</span> <span class="p">;</span>

   <span class="n">traceability</span> <span class="o">=</span> 
      <span class="s2">&quot;Calibrated 20170210. Uncertainty of flow = 0.44</span><span class="si">% + i</span><span class="s2">nstrument resolution.&quot;</span> <span class="p">;</span>

   <span class="n">cal_flag</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span>

   <span class="n">flows_reported</span> <span class="o">=</span>
  <span class="mf">1.046</span><span class="p">,</span> <span class="mf">0.996</span><span class="p">,</span> <span class="mf">0.911</span><span class="p">,</span> <span class="mf">0.789</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">,</span> <span class="mf">0.611</span><span class="p">,</span> <span class="mf">0.522</span><span class="p">,</span> <span class="mf">0.397</span><span class="p">,</span> <span class="mf">0.334</span><span class="p">,</span> <span class="mf">0.235</span><span class="p">,</span> 
      <span class="mf">0.148</span><span class="p">,</span> <span class="mf">0.115</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> 
      <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> 
      <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="p">;</span>

   <span class="n">flows_actual</span> <span class="o">=</span>
  <span class="mf">0.919</span><span class="p">,</span> <span class="mf">0.879</span><span class="p">,</span> <span class="mf">0.808</span><span class="p">,</span> <span class="mf">0.699</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.542</span><span class="p">,</span> <span class="mf">0.455</span><span class="p">,</span> <span class="mf">0.344</span><span class="p">,</span> <span class="mf">0.275</span><span class="p">,</span> <span class="mf">0.185</span><span class="p">,</span> 
      <span class="mf">0.071</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> 
      <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> 
      <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="p">;</span>

   <span class="n">flow_fit</span> <span class="o">=</span> <span class="s2">&quot;0.280*x**3 - 0.672*x**2 + 1.397*x - 0.123&quot;</span> <span class="p">;</span>
  <span class="p">}</span> <span class="o">//</span> <span class="n">group</span> <span class="n">flow_cal</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="appending-to-existing-cal-nc-file">
<h2>Appending to existing <cite>cal-nc</cite> file<a class="headerlink" href="#appending-to-existing-cal-nc-file" title="Permalink to this headline">¶</a></h2>
<p>Note that it is up to the user to ensure that data appended to an existing file
is sensible. This is especially true as it is possible for example to append diameter data for different particle refractive indices without any form of indication in the variable attributes.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(cal-nc) user@pc:~/git/cal-nc$ python cal_ncgen.py &#39;testing/PCASP-2_faam_20191107_v001_r000_cal.nc&#39;</span>
<span class="go">    -u bin_cal/time 20200128</span>
<span class="go">    -u bin_cal/applies_to C213</span>
<span class="go">    -u bin_cal/traceability &quot;269nm (#166237). 303nm (#196947). 345nm (#199283). 401nm (#211099). 453nm (#166631). 510nm (#218477). 600nm (#213249). 702nm (#211842). 803nm (#209453). 903nm (#218704). 994nm (#200992). 1.101um (#212683). 1.361um (#199629). 1.592um (#204268). 1.745um (#205235). 2.020um (#181058). 2.10 um (#213339). 2.504um (#190272). 3.007um (#185943).&quot;</span>
<span class="go">    -u bin_cal/cal_flag 0</span>
<span class="go">    -u bin_cal/cal_flag 1</span>
<span class="go">    -u parsefile testing/20200128_P2_cal_results_PSLd.csv</span>
<span class="go">    --user=&quot;Graeme Nott &lt;graeme.nott@faam.ac.uk&gt;&quot;</span>
<span class="go">    --hist=&quot;&lt;now&gt; Cal for FAAM test flight&quot;</span>
<span class="go">    -o &#39;testing/PCASP-2_faam_20191107_v001_r001_cal.nc&#39;</span>
</pre></div>
</div>
<p>This command will append the size calibration data from <code class="docutils literal notranslate"><span class="pre">testing/20200128_P2_cal_results_PSLd.csv</span></code> to that in <code class="docutils literal notranslate"><span class="pre">testing/PCASP-2_faam_20191107_v001_r000_cal.nc</span></code> and save the result as new revision of the same file <code class="docutils literal notranslate"><span class="pre">testing/PCASP-2_faam_20191107_v001_r001_cal.nc</span></code>. Variables that are not included in the .csv file are included using the <code class="docutils literal notranslate"><span class="pre">--update</span></code> or <code class="docutils literal notranslate"><span class="pre">-u</span></code> option. Variable names given in this way must include the path to the variable in the netCDF, in this case the information in the calibration csv file should go in the <code class="docutils literal notranslate"><span class="pre">bin_cal</span></code> group. Note that multiple <code class="docutils literal notranslate"><span class="pre">--update</span></code>’s of a single variable are acceptable as shown for the <code class="docutils literal notranslate"><span class="pre">bin_cal/cal_flag</span></code> variable. However as only as single calibration source csv has been given the second one is ignored.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="_source/modules.html" title="cal-nc"
             >next</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Creation/updates of nc files for FAAM calibration data 0.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, FAAM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>